# encoding: utf-8
#

require 'spec_helper'
require '000/sha1_bitwise_compress0'
require '128/sha1_bitwise_compress0_17b06b6dcb0638190df496928b3c550dee3f2a3d'

describe SHA1BitwiseCompress0_T001_T002_F003_F004_F005_T006_T007_F008_T009_F010_F011_T012_F013_F014_F015_T016_F017_F018_F019_F020_T021_F022_F023_T024_F025_T026_F027_T028_T029_F030_F031_F032_F033_F034_T035_F036_T037_T038_F039_F040_T041_T042_T043_F044_F045_F046_F047_F048_F049_F050_F051_F052_F053_F054_F055_F056_T057_F058_T059_F060_F061_T062_T063_T064_F065_T066_T067_T068_T069_T070_F071_T072_T073_T074_T075_T076_T077_T078_F079_F080_F081_F082_F083_F084_F085_F086_F087_T088_T089_F090_T091_F092_F093_F094_F095_T096_T097_F098_T099_F100_T101_F103_T105_T107_T109_T110_T111_T112_T113_T115_T116_F117_T118_F119_T120_T121_F122_F123_F124_F125_T126_F127_F128_T153_T154_F155_F157_F159, '#compress_0' do

# T001_T002_F003_F004: c
# F005_T006_T007_F008: 6
# T009_F010_F011_T012: 9
# F013_F014_F015_T016: 1
# F017_F018_F019_F020: 0
# T021_F022_F023_T024: 9
# F025_T026_F027_T028: 5
# T029_F030_F031_F032: 8

# F033_F034_T035_F036: 2
# T037_T038_F039_F040: c
# T041_T042_T043_F044: e
# F045_F046_F047_F048: 0
# F049_F050_F051_F052: 0
# F053_F054_F055_F056: 0
# T057_F058_T059_F060: a
# F061_T062_T063_T064: 7

# F065_T066_T067_T068: 7
# T069_T070_F071_T072: d
# T073_T074_T075_T076: f
# T077_T078_F079_F080: c
# F081_F082_F083_F084: 0
# F085_F086_F087_T088: 1
# T089_F090_T091_F092: a
# F093_F094_F095_T096: 1

# T097_F098_T099_F100: a
# T101_F103          : 8
# T105_T107          : a
# T109_T110_T111_T112: f
# T113_T115_T116     : b
# F117_T118_F119_T120: 5
# T121_F122_F123_F124: 8
# F125_T126_F127_F128: 4

#                    : 0
#                    : 0
#                    : 0
#                    : 0
#                    : 0
#                    : 0
# T153_T154_F155     : c
# F157_F159          : 0

  it 'calculates 512 * false + restrictions correctly' do
    iv = [0xc6910958, 0x2ce000a7, 0x7dfc01a1, 0xa8afb584, 0x000000c0, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000]
    expected = SHA1BitwiseCompress0.new.compress_0(iv)
    actual = SHA1BitwiseCompress0_T001_T002_F003_F004_F005_T006_T007_F008_T009_F010_F011_T012_F013_F014_F015_T016_F017_F018_F019_F020_T021_F022_F023_T024_F025_T026_F027_T028_T029_F030_F031_F032_F033_F034_T035_F036_T037_T038_F039_F040_T041_T042_T043_F044_F045_F046_F047_F048_F049_F050_F051_F052_F053_F054_F055_F056_T057_F058_T059_F060_F061_T062_T063_T064_F065_T066_T067_T068_T069_T070_F071_T072_T073_T074_T075_T076_T077_T078_F079_F080_F081_F082_F083_F084_F085_F086_F087_T088_T089_F090_T091_F092_F093_F094_F095_T096_T097_F098_T099_F100_T101_F103_T105_T107_T109_T110_T111_T112_T113_T115_T116_F117_T118_F119_T120_T121_F122_F123_F124_F125_T126_F127_F128_T153_T154_F155_F157_F159.new.compress_0(iv)
    expect(actual).to eq(expected)
  end
end
